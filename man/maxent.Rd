% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/maxent.R
\name{maxent}
\alias{maxent}
\title{MaxEnt Grammar}
\usage{
maxent(
  tableau,
  obs_col = "obs",
  mu = NULL,
  sigma = NULL,
  upper_bound = 10,
  temperature = 1,
  use_gradient = TRUE
)
}
\arguments{
\item{tableau}{The data object (data frame or tibble) containing an \code{input} column
and an \code{output} column, in addition to all relevant constraints, their respective
violations, and a column \code{obs} containing the number of observations for each output}

\item{obs_col}{Name of the column containing the number of observations for each output (default: \code{obs})}

\item{mu}{The desired mean for the Gaussian prior}

\item{sigma}{The desired standard deviation for the Gaussian prior}

\item{upper_bound}{The maximum value allowed for constraint weights (default: 10)}

\item{temperature}{Controls "sharpness" of candidate probabilities. Default behavior is \code{temperature = 1}. Lower values make distributions sharper (favor one candidate strongly);
higher values make distributions flatter (probabilities more even)}

\item{use_gradient}{Whether the function should use a gradient function (default: TRUE) to
optimize its search for constraint weights}
}
\value{
A list with the following components:
\itemize{
  \item \code{predictions} — a tibble containing the original tableau(s) with added columns: \code{harmony} (score for each candidate), \code{max_h} (maximum harmony within each input), \code{exp_h}, \code{Z} (partition function within each input), \code{obs_prob} (observed probabilities), \code{pred_prob} (predicted probabilities), and \code{error} (difference between observed and predicted probabilities).
  \item \code{weights} — a named numeric vector of the learned constraint weights.
  \item \code{log_likelihood} — the log-likelihood of the model fit.
  \item \code{log_likelihood_norm} — the normalized log-likelihood (log-likelihood divided by number of rows).
  \item \code{bic} — the Bayesian Information Criterion (BIC) value for the fitted model.
}
}
\description{
Given an object with one or more tableaux, the function returns the
weights for the set of constraints.
}
\examples{
maxent_data <- tibble::tibble(
  input = rep(c("pad", "tab", "bid", "dog", "pok"), each = 2),
  output = c("pad", "pat", "tab", "tap", "bid", "bit", "dog", "dok", "pog", "pok"),
  ident_vce = c(0, 1, 0, 1, 0, 1, 0, 1, 1, 0),
  no_vce_final = c(1, 0, 1, 0, 1, 0, 1, 0, 1, 0),
  obs = c(5, 15, 10, 20, 12, 18, 12, 17, 4, 8)
)
maxent(tableau = maxent_data)
}
